<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
    <title>Arts spending by American</title>

    <!-- D3 and JQuery Javascript -->
    <script src="https://d3js.org/d3.v3.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>
    <script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

    <!-- Parallel Sets (optional) -->
    <link rel="stylesheet" href="css/parsets.css" type="text/css">
    <script type="text/javascript" src="js/d3.parsets.js"></script>

    <!-- Bootstrap Core CSS  -->
    <link href="css/bootstrap.css" rel="stylesheet">

    <!-- Custom CSS -->
    <link href="css/custom.css" rel="stylesheet">
    <link href="css/portfolio.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Lora:400,700" rel="stylesheet">

    <style>
        div.tooltips {
            z-index: 99;
            position: absolute !important;
            background-color: #fff;
            opacity: 0.9;
            padding: 5px;
        }

        tspan {
            font-family: 'Avenir Next', sans-serif;
            font-size: 14px;
            fill: #444;
            font-weight: 400; 
        }

        .dimension tspan.name {
            font-family: 'Avenir Next', sans-serif;
            font-size: 24px;
            fill: #333;
            font-weight: 600;
        }

        .category text{
            font-family: 'Avenir Next', sans-serif;
            font-size: 16px;
            fill: #333;
            font-weight: 400; 
        }

        div.cover-image{
            margin-top: 90px;
            height: 420px;
            background: url(images/cover.jpg) no-repeat center center fixed;
            background-size: cover;
            background-position: 0px 48px;
        }
    </style>
</head>
<body id="page-top" class="index">
    <!-- Navigation Bar -->
    <div class="navbar nav-fix-top">
        <div class="row">
            <div class="col-md-10 col-md-offset-1 col-xs-12 text-center">
                <div class="container">
                    <a class="page-header" id="title-header" href="../index.html">
                        <h1 class="text-shrink">Abhraneel Sarma</h1>
                    </a>
                    
                    <div class="hr">
                        <div class="row">
                            <div class="col-sm-2 col-sm-offset-3 col-xs-4">
                                <div class="nav-page-tabs">
                                    <div class="current-page">
                                        <a class="quick-links-current" href="../index.html">Work</a>
                                    </div>
                                </div>
                            </div>
                            <div class="col-sm-2 col-xs-4">
                                <div class="nav-page-tabs">
                                    <a class="quick-links" href="https://drive.google.com/file/d/0B7ZA2gHdFDLhdS1PcTJvRTFCVG8/view?usp=sharing" target="_blank">Resume</a>
                                </div>
                            </div>
                            <div class="col-sm-2 col-xs-4">
                                <div class="nav-page-tabs">
                                    <a class="quick-links" href="../about/index.html">About</a>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <section id="portfolio">
        <div class="container-fluid">
            <div class="cover-image"></div>
        </div>
        <div class="container">
            <div class="row">
                <div class="col-md-10 col-md-offset-1 col-sm-12">
                    <h2 class="title margin-top-lg">Analysing how Americans engage in Arts</h2>
                    <h4 class="page-sub-header margin-top-lg">Overview</h4>
                    <div class="row">
                        <div class="col-md-6">
                            <p class="body-text">In this project we used the dataset provided by Interuniversity Consortium for Political and Social Research’s (ICPSR) Survey of Public Participation in the Arts. This is a particularly rich dataset obtained from a survey conducted about people's participation in different artforms in 5 different years since 1982.</p>
                        </div>
                        <div class="col-md-6">
                            <p class="body-text">It has both hierarchical and multivariate data, which contains parameters such as Year, Region, Income, Education level and Age of the participants along with other information.</p>
                        </div>
                    </div>

                    <h4 class="page-sub-header margin-top-xl">The Visualization</h4>
                    <div class="row">
                        <div class="col-md-6">
                            <p class="body-text">To develop our visualization, we first defined the types of tasks that this dataset affords: determining <b>the popularity of different artforms</b>, the <b>distribution by region</b> for each artform and <b>the demographic distribution of people interested in a particular artform</b>.</p>
                        </div>
                        <div class="col-md-6">
                            <p class="body-text">We found that treemaps are perfectly suited for the first two tasks as it allows the efficient visualization of hierarchical dataset. In this visualization, we show the relative popularity of different artforms across the 5 surveys.</p>
                        </div>
                    </div>
                    <p class="note-text margin-top-sm">Note: Currently the treemaps only afford the first task. We are changing this shortly to a zoomable Treemap to include state data as well.</p>
                </div>
                <div class="col-md-8 col-md-offset-1 col-sm-12">
                    <div class="margin-top-lg">
                        <svg  id="treemap" width="800" height="450"></svg>
                    </div>
                </div>

                <div class="col-md-10 col-md-offset-1 col-sm-12">
                    <h4 class="page-sub-header margin-top-xl">Visualization of Demographic Distribution</h4>
                    <div class="row">
                        <div class="col-md-6">
                            <p class="body-text">When we look at the demographic information such as income, age and education, we wish to find <b>the category most of the people belong</b> to. We base our solution on Parallel Sets, a visualization strategy for multivariate, categorical data.</p>
                        </div>
                        <div class="col-md-6">
                            <p class="body-text">Parsets allows the user to look at the distribution by these categories, reorder these categories and look at the sub categories.</p>
                        </div>
                    </div>
                </div>
                <div class="col-lg-11 col-lg-offset-1 margin-top-lg">
                    <div class="btn-tabs btn-active text-center" onclick="setParsets(this.innerText)">Art Museum</div>
                    <div class="btn-tabs text-center" onclick="setParsets(this.innerText)">Ballet</div>
                    <div class="btn-tabs text-center" onclick="setParsets(this.innerText)">Classical</div>
                    <div class="btn-tabs text-center" onclick="setParsets(this.innerText)">Craft Fair</div>
                    <div class="btn-tabs text-center" onclick="setParsets(this.innerText)">Dance</div>
                    <div class="btn-tabs text-center" onclick="setParsets(this.innerText)">Festival</div>
                    <div class="btn-tabs text-center" onclick="setParsets(this.innerText)">Jazz</div>
                    <div class="btn-tabs text-center" onclick="setParsets(this.innerText)">Musical</div>
                    <div class="btn-tabs text-center" onclick="setParsets(this.innerText)">Opera</div>
                    <div class="btn-tabs text-center" onclick="setParsets(this.innerText)">Parks</div>
                    <div class="btn-tabs text-center" onclick="setParsets(this.innerText)">Play</div>
                    <div class="btn-tabs text-center" onclick="setParsets(this.innerText)">Salsa</div>
                </div>
                <div class="col-lg-10 col-lg-offset-1 col-sm-12">
                    <div class="margin-top-sm" id="parsets">
                        <svg id="parsets" width="960" height="600"></svg>
                    </div>
                </div>
                <div class="col-md-10 col-md-offset-1 col-sm-12">
                    <div class="row">
                        <div class="col-md-6">
                            <h4 class="page-sub-header margin-top-xl">Going Forward</h4>
                            <p class="body-text">Taking this forward, one interesting analysis that a visualization could afford is to see how people share interests and how can demographics influence these interests. For example: <b>do people who belong to certain demographic and are interested in a particular artform have a propensity to share interests?</b></p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="page-footer margin-top-xl">
            <p class="footer-text text-center">Abhraneel Sarma © 2017</p>
        </div>
    </section>
</body>

<script>
    var svg = d3.select("svg#treemap"),
        width = +svg.attr("width"),
        height = +svg.attr("height");

    var color = d3.scale.category20c()
                    .range(["#5EA3C3", "#79B9CC", "#8CC8D2", "#A0D8D9", "#B1E6DE", "#B2DDDC", "#B4D2DB", "#B1C3D8", "#AFB4D5", "#ACA3D1", 
                        "#B5A3CD", "#C1A7C8", "#CEADC4", "#DCB2BE", "#E9B7BA", "#E1BDBE", "#D5C0C1", "#C2C6C8", "#B2CCCE", "#A4CFD2"]);

    var treemap = d3.layout.treemap()
                    .size([width, height])
                    .round(true)
                    .value(function(d) {
                        return d.size;
                    });

    function initialize(root) {
        root.x = root.y = 0;
        root.dx = width;
        root.dy = height;
        root.depth = 0;
    }

    d3.json("datasets/treemap.json", function(error, data) {
        if (error) throw error;
        
        treemap(data)

        var cell = svg.selectAll("g")
                    .data(data["children"])
                    .enter().append("g")
                    .attr("transform", function(d) { return "translate(" + d.x + "," + d.y + ")"; });

        cell.append("rect")
            .attr("id", function(d) { return d.name; })
            .attr("width", function(d) { return d.dx; })
            .attr("height", function(d) { return d.dy ; })
            .attr("fill", function(d) { return color(d.name); });

        cell.append("clipPath")
            .attr("id", function(d) { return "clip-" + d.name; })
            .append("use")
            .attr("xlink:href", function(d) { return "#" + d.name; });

        cell.append("text")
            .attr("clip-path", function(d) { return "url(#clip-" + d.name + ")"; })
            .append("tspan")
            .attr("x", 4)
            .attr("y", function(d, i) { return 18; })
            .text(function(d) { return d.name; });

        cell.append("title")
            .text(function(d) { return d.name + "\n" + d.value; });
    });


    var chart = d3.parsets();
    
    chart.dimensions(["Artform", "Income", "Age"]);

    var parsets = d3.select("svg#parsets").append("svg");

    /*var body = d3.select(".tooltip-container");
    var tooltips = body.append("div")
        .attr("class", "parsets tooltips");*/

    var dataset

    d3.csv("datasets/parsets.csv", function(error, data) {
        if (error) throw error;
        dataset = data;

        setParsets('Art Museum');
    })

    function setParsets(text){
        data = dataset.filter(function(row) {
            return row['Artform'] == text;
        })
        drawParsets(data);

        $("div.btn-tabs").on("click", function(){
            $("div.btn-tabs").removeClass("btn-active");
            $(this).addClass("btn-active")
        })
    }

    function drawParsets(data){
        parsets.datum(data).call(chart);

        /*chart.tooltip(function(d, i){
            var count = d.count, path = [];
            while (d.parent) {
              if (d.name) path.unshift(d.name);
              d = d.parent;
            }
            
            var x = 0, y = 0, eTop = $('#vis').offset().top;
            x = d3.mouse(body.node())[0];
            y = d3.mouse(body.node())[1] + 460;

            //console.log(eTop);

            d3.select(".tooltips")
                .style("left", ((x+20) + "px"))
                .style("top", ((y-20-140) + "px"))
                .html(path.join(" → ") + "<br>" + count + " (" + Math.round((count/d.count)*100)+ "%)");
        })*/
    }
</script>
<script>
        (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
        (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
        m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

        ga('create', 'UA-79877752-1', 'auto');
        ga('send', 'pageview');
</script>
</html>
